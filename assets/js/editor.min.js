! function(t) {
	"use strict";
	var templatesEndpoint = 'https://yourdomain.com/templates.json';
	var e, s = window.CJTemplateControls || {},
		a = {
			1: {
				name: "Reserved for the theme",
				sub_categories: {}
			},
			2: {
				name: "General",
				sub_categories: {}
			},
			3: {
				name: "Business",
				sub_categories: {}
			},
			4: {
				name: "Cafe & Restaurant",
				sub_categories: {}
			},
			5: {
				name: "Medical",
				sub_categories: {}
			},
			6: {
				name: "Health & Beauty",
				sub_categories: {}
			},
			7: {
				name: "E-Commerce",
				sub_categories: {}
			},
			8: {
				name: "Travel",
				sub_categories: {}
			},
			9: {
				name: "Technology",
				sub_categories: {}
			},
			10: {
				name: "Sports",
				sub_categories: {}
			},
			11: {
				name: "Blog",
				sub_categories: {}
			}
		},
		m = {
			theme: {
				name: "",
				layout: "cj-3-column"
			},
			section: {
				name: "Sections",
				layout: "cj-3-column"
			}
		},
		r = {};
	if ("object" == typeof CJThemeLibrary.templates) {
		var i = _.escape(CJThemeLibrary.themeName).replace(/\s+/g, "-").toLowerCase();
		a[1] = {
			name: CJThemeLibrary.themeName,
			sub_categories: {}
		}, m.theme = {
			name: CJThemeLibrary.themeName,
			layout: "cj-3-column cj-theme-library"
		}, _.each(CJThemeLibrary.templates, function(t, e) {
			r = {
				...r,
				[i + "-" + e]: {
					isTheme: !0,
					name: t.name,
					tags: t.tags,
					categories: [1],
					type: t.type,
					imgUrl: t.imgUrl,
					largeImgUrl: t.largeImgUrl,
					templateUrl: t.templateUrl
				}
			}
		})
	} else delete m.theme, delete a[1];

	var g = {
			...r,
			...{
				1: {
					tags: ["accordion", "light", "faq"],
					type: ["section"],
					categories: [2],
					name: "FAQ",
					imgUrl: "https://elements.keystonethemes.com/assets/img/faq1.png",
					largeImgUrl: "https://elements.keystonethemes.com/assets/img/faq1.png"
				},
			}
		},

		

		l = '<div class="cj-library-starter-button"><img class="cj-library-starter-button-svg" src="' + CJEditorParams.cjURL + '/assets/img/icon.svg"></div>',
		o = '    \n        <div class="cj-modal dialog-widget dialog-lightbox-widget dialog-type-buttons dialog-type-lightbox elementor-templates-modal">\n            <div id="cj-library-wrapper">\n                <div id="cj-library">\n                    <div id="cj-library-header">\n                        <div id="cj-library-tabs">\n                            <div class="cj-library-tab-logo">\n                                <a href="https://www.www.keystonethemes.com" target="_blank"><img src="' + CJEditorParams.cjURL + '/assets/img/logo.png" /></a>\n                            </div>      \n                                                    \n                            <div id="cj-library-tabs-holder">\n                                <template id="cj-library-tab-item">\n                                    <div class="cj-library-tab-item">\n                                        <label class="cj-library-tab-label"> \n                                            <span>{tabname}</span>\n                                        </label>\n                                    </div> \n                                </template>\n                            </div>\n                            \n\n                            <div class="cj-library-tab-item cj-library-tags-tab">\n                                <label class="cj-library-tab-label"> \n                                    <span>Tags</span>\n                                </label>\n\n                                <div id="cj-library-tags-holder">\n                                    <template id="cj-library-tag-item">\n                                        <div class="cj-library-tag-item">\n                                            <label class="cj-library-tag-label"> \n                                                {tagname}\n                                                <span>{tagcount}</span>\n                                            </label>\n                                        </div> \n                                    </template>                                \n                                </div>\n                            </div> \n\n\n                            <div class="cj-library-tab-search"> \n                                <input id="cj-library-search" type="text" class="cj-library-search-input" placeholder="Search..." />\n                                <i class="eicon-search-bold"></i>                           \n                            </div>\n\n                        </div>\n                        <div id="cj-library-close"><i class="eicon-close"></i> </div>\n                    </div>\n                    <div id="cj-library-content" class="cj-3-column">\n                    <div id="cj-library-loading"></div>\n                    <div id="cj-library-no-result"><div class="no-result-inner">Sorry, No Results Found!</div></div>\n                        <div id="cj-library-filters-container">\n                            <div id="cj-library-filters"> \n                                <template id="cj-library-filter-item">\n                                    <div class="cj-library-filter-item">\n                                        <label class="cj-library-filter-label">                                                               \n                                            {categoryname}<span>{count}</span>\n                                        </label>\n                                    </div>\n                                </template>\n                            </div>\n                        </div>\n                        <div id="cj-library-templates">\n                            <div id="cj-library-masonry">\n                                <template id="cj-library-masonry-item">\n                                    <div class="cj-library-masonry-item" id="{itemid}">\n                                        <div class="cj-library-masonry-item-inner cj-template-loading">\n                                            <a href="#" class="cj-library-item-preview" data-featherlight="{imgsrc}"><i class="eicon-zoom-in-bold"></i></a>\n                                            <img class="cj-library-masonry-item-img" src="{imgsrc}" />\n                                            <div class="cj-library-masonry-item-caption">{insertorpro}</div>\n                                        </div>\n                                    </div>\n                                </template>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>    \n    ';
		e = {
		init: function() {
			window.elementor.on("preview:loaded", window._.bind(e.onPreviewLoaded, e))
		},
		onPreviewLoaded: function() {
			var a = this;
			setTimeout(function() {
				a.initStarterButton(), a.onSearch()
			}, 100), window.elementor.$previewContents.on("click.elementor-editor-element-add", function(a) {
				if (!(t(a.target).find(".cj-library-starter-button").length > 0)) {
					if (!(t(a.target).hasClass("eicon-plus") || t(a.target).hasClass("elementor-add-new-section") || t(a.target).hasClass("elementor-editor-element-add"))) return t(a.target).hasClass("cj-library-starter-button-svg") ? (e.onInitiateModel(), s.model.fadeIn(), void(s.modelOpener = t(a.target).parents(".elementor-edit-mode").first().data("model-cid"))) : void 0;
					t(this);
					setTimeout(function() {
						var e;
						e = t(a.target).parents(".elementor-element-edit-mode").first().prev().find(".elementor-add-new-section").first(), s.modelID = t(a.target).parents(".elementor-element-edit-mode").data("model-cid"), e.length && (s.starterButton = t(l), s.starterButton.prependTo(e), s.insertSection = e)
					}, 200)
				}
			})
		},
		onTabClick: function() {
			t(s.tabHolder).find(".cj-library-tab-item").on("click", function() {
				var a = t(this).data("tabid");
				t(s.tabsContainer).find(".cj-library-tag-item").removeClass("selectedTag"), t(s.tabsContainer).find(".cj-library-tags-tab .cj-library-tab-label span small").remove(), t(s.tabHolder).find(".cj-library-tab-item").removeClass("isActive"), t(s.tabsContainer).find(".cj-library-tags-tab").removeClass("isActive"), t(this).addClass("isActive"), s.currentTab = t(this);
				var m = _.filter(g, function(t, e) {
					return g[e].id = e, _.find(t.type, function(t) {
						return t === a
					})
				});
				t("#cj-library-content").removeClass().addClass(t(this).data("layout")), e.onInsertTemplates(m)
			}), t(s.tabHolder).find(".cj-tab-section").trigger("click")
		},
		onInsertTemplates(m) {
			var r = document.getElementById("cj-library-masonry"),
				i = document.getElementById("cj-library-masonry-item").content.querySelector(".cj-library-masonry-item");
			s.templatesHolder = r, t(s.templatesHolder).find(".cj-library-masonry-item").removeClass("isVisible isFiltered");
			var l = l || {},
				o = "";
			t.isEmptyObject(m) ? t("#cj-library-no-result").show() : (t("#cj-library-no-result").hide(), _.each(m, function(s, m) {
				s.inserted || (o = document.importNode(i, !0), t(o).attr("id", "template-" + s.id), t(o).data("id", s.id), s.isPro && t(o).find(".cj-library-masonry-item-inner").addClass("cj-pro"), t(o).find(".cj-library-masonry-item-caption").html("<span class='temp-title'>" + s.name + "</span>"), t(o).find(".cj-library-masonry-item-caption").append("<span class='insert-temp'><i class='eicon-file-download' aria-hidden='true'></i>Insert</span>"), _.each(s.categories, function(e) {
					t(o).addClass("cj-category-" + e)
				}), _.each(s.tags, function(e) {
					t(o).addClass("cj-tag-" + encodeURIComponent(e))
				}), r.appendChild(o), g[s.id].inserted = !0, t(o).find("img").attr("src", s.imgUrl), t(o).find("a.cj-library-item-preview").attr("data-featherlight", s.largeImgUrl), t("#template-" + s.id).imagesLoaded(function() {
					t("#template-" + s.id).find(".cj-library-masonry-item-inner").removeClass("cj-template-loading")
				}), t(o).find(".cj-library-masonry-item-caption span.insert-temp").on("click", function() {
					e.onImport(s.id)
				})), t("#template-" + s.id).addClass("isVisible"), _.each(s.categories, function(t, e) {
					l[t] = a[t], l[t].count = l[t].count ? l[t].count + 1 : 1
				})
			}));
			var n = document.getElementById("cj-library-filters"),
				c = document.getElementById("cj-library-filter-item").content.querySelector(".cj-library-filter-item"),
				h = "";
			t(n).find(".isVisible").remove(), _.each(l, function(s, a) {
				h = document.importNode(c, !0), t(h).data("catid", a), t(h).addClass("isVisible"), t(h).find(".cj-library-filter-label").html(s.name + "<span>" + s.count + "</span>"), t(h).on("click", function() {
					e.onCategoryClick(this)
				}), n.appendChild(h)
			}), _.each(l, function(t) {
				t.count = 0
			}), s.categoryHolder = t(n)
		},
		onImport: function(e) {
			var a = document.getElementById("cj-library-loading");
			t(a).fadeIn(), t.ajax({
				url: g[e].isTheme ? CJEditorParams.root + "KEA/get-json/theme/" + e.replace(i + "-", "") : CJEditorParams.root + "KEA/get-json/local/" + e,
				method: "GET",
				beforeSend: function(t) {
					t.setRequestHeader("X-WP-Nonce", CJEditorParams.nonce)
				}
			}).done(function(m) {
				console.log("%c Template #" + e + " has been imported!", "color: #fff; background-color: #009ffd;padding:10px;"), window.elementor.previewView.collection.length && t.each(window.elementor.previewView.collection.models, function(t, e) {
					s.modelID === e.cid && (s.elModel = e, s.templateIndex = t)
				}), window.elementor.previewView.addChildModel(m.content, {
					at: s.templateIndex
				}), s.model.fadeOut(), t(a).fadeOut()
			})
		},
		onSearch: function() {
			t("#cj-library-search").on("keyup", function() {
				t("#cj-library-content").removeClass().addClass("cj-3-column"), t(s.tabsContainer).find(".cj-library-tag-item").removeClass("selectedTag"), t(s.tabsContainer).find(".cj-library-tags-tab .cj-library-tab-label span small").remove(), clearTimeout(r);
				var a = this.value,
					m = new RegExp(a, "gi"),
					r = setTimeout(function() {
						var t = _.filter(g, function(t, e) {
								return g[e].id = e, _.find(t.tags, function(t) {
									if (void 0 !== t) return null != t.match(m)
								})
							}),
							s = _.filter(g, function(t, e) {
								return null != t.name.match(m)
							});
						e.onInsertTemplates({
							...t,
							...s
						})
					}, 400)
			})
		},
		onInitiateModel: function() {
			if (!(t("body").find(".cj-modal").length > 0)) {
				s.model = t(o), s.model.appendTo("body");
				var a, r = document.getElementById("cj-library-tabs-holder"),
					i = document.getElementById("cj-library-tab-item").content.querySelector(".cj-library-tab-item");
				_.each(m, function(e, s) {
					a = document.importNode(i, !0), t(a).data("tabid", s).data("layout", e.layout).addClass("cj-tab-" + s).find("span").html(e.name), r.appendChild(a)
				}), s.tabHolder = t(r), e.onTabClick();
				var l, n = document.getElementById("cj-library-tags-holder"),
					c = document.getElementById("cj-library-tag-item").content.querySelector(".cj-library-tag-item"),
					h = {};
				_.each(g, function(t, e) {
					_.each(t.tags, function(t, e) {
						h[[t]] ? h[[t]].count = h[[t]].count + 1 : h[[t]] = {
							id: [e],
							name: [t],
							count: 1
						}
					})
				}), _.each(h, function(s, a) {
					l = document.importNode(c, !0), t(l).data("tagname", s.name), t(l).find(".cj-library-tag-label").html(s.name + "<span>" + s.count + "</span>"), t(l).on("click", function() {
						e.onTagClick(this)
					}), n.appendChild(l)
				}), e.onSearch(), s.model.find("#cj-library-close").on("click", function() {
					s.model.fadeOut()
				})
			}
		},
		onCategoryClick: function(e) {
			t("#cj-library-filters").find(".cj-library-filter-item").removeClass("isActive");
			var s = t(e).data("catid");
			t(e).addClass("isActive"), t("#cj-library-masonry").find(".cj-library-masonry-item.isVisible").each(function() {
				t(this).hasClass("cj-category-" + s) ? t(this).removeClass("isFiltered") : t(this).addClass("isFiltered")
			})
		},
		onTagClick: function(a) {
			t(s.templatesHolder).removeClass().addClass("cj-3-column");
			var m = document.getElementById("cj-library-tabs");
			s.tabsContainer = t(m), t(s.tabHolder).find(".cj-library-tab-item").removeClass("isActive"), t(s.tabsContainer).find(".cj-library-tags-tab").addClass("isActive");
			var r = t(a).data("tagname"),
				i = _.filter(g, function(t, e) {
					return g[e].id = e, _.find(t.tags, function(t) {
						if (void 0 !== t) return t == r
					})
				});
			t(s.tabsContainer).find(".cj-library-tag-item").removeClass("selectedTag"), t(a).addClass("selectedTag"), t(s.tabsContainer).find(".cj-library-tags-tab .cj-library-tab-label span small").remove(), t(s.tabsContainer).find(".cj-library-tags-tab .cj-library-tab-label span").append("<small>" + r + "</small>"), e.onInsertTemplates(i), t("#cj-library-masonry").find(".cj-library-masonry-item").each(function() {
				t(this).hasClass("cj-tag-" + encodeURIComponent(r)) ? t(this).addClass("isVisible") : t(this).removeClass("isVisible").removeClass("isFiltered")
			})
		},
		initStarterButton: function() {
			setTimeout(function() {
				var a = window.elementor.$previewContents.find(".elementor-add-new-section");
				a.length && (s.starterButton = t(l), s.starterButton.prependTo(a), s.starterButton.one("click", function() {
					e.onInitiateModel(), s.model.fadeIn()
				}))
			}, 1e3)
		}
	}, t(window).on("elementor:init", e.init)
}(jQuery);